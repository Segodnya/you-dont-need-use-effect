---
import BaseSlide from './BaseSlide.astro';
import CodeComparison from '../CodeComparison.astro';
import Text from '../ui/Text.astro';
import Callout from '../ui/Callout.astro';
import Section from '../ui/Section.astro';
---

<BaseSlide id="state-chains" title="4. Цепочки обновлений состояния">
  <Section>
    <Text>
      Эффект-лабиринт: каждый эффект запускает следующий, создавая цепочку обновлений.
    </Text>

    <CodeComparison
      badCode={`// Длинная цепочка эффектов
useEffect(() => {
  if (card !== null && card.gold) {
    setGoldCardCount(c => c + 1);
  }
}, [card]);

useEffect(() => {
  if (goldCardCount > 3) {
    setRound(r => r + 1);
    setGoldCardCount(0);
  }
}, [goldCardCount]);`}
      goodCode={`// Вся логика в одном месте
function handleCardPick(nextCard) {
  setCard(nextCard);

  if (nextCard.gold) {
    if (goldCardCount <= 3) {
      setGoldCardCount(prev => prev + 1);
    } else {
      setGoldCardCount(0);
      setRound(prev => prev + 1);
    }
  }
}`}
      language="tsx"
    />

    <Callout variant="tip">
      Объединяйте связанные обновления состояния в одном месте (обычно в обработчиках событий).
    </Callout>
  </Section>
</BaseSlide>
